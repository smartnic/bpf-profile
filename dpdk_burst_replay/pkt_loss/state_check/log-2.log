          <idle>-0       [008] ..s2. 4779449.358883: bpf_trace_printk: 

          <idle>-0       [008] ..s2. 4779449.358888: bpf_trace_printk: Receive a packet on cpu 8
          <idle>-0       [008] ..s2. 4779449.358889: bpf_trace_printk: cur_pkt_id: 1
          <idle>-0       [008] ..s2. 4779449.358890: bpf_trace_printk: [add_metadata_to_log] add pkt 1 to ring[0]
          <idle>-0       [008] ..s2. 4779449.358891: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 1, tcp_fin_flag: 0
          <idle>-0       [008] ..s2. 4779449.358892: bpf_trace_printk: [add_metadata_to_log] next_loc: 1, pkt_min: 1 pkt_max: 1
          <idle>-0       [008] ..s2. 4779449.358893: bpf_trace_printk: [update_state_by_metadata] insert state 1 for src ip 6401a8c0
          <idle>-0       [008] ..s2. 4779449.360964: bpf_trace_printk: 

          <idle>-0       [008] ..s2. 4779449.360966: bpf_trace_printk: Receive a packet on cpu 8
          <idle>-0       [008] ..s2. 4779449.360966: bpf_trace_printk: cur_pkt_id: 3
          <idle>-0       [008] ..s2. 4779449.360967: bpf_trace_printk: [add_metadata_to_log] add pkt 2 to ring[1]
          <idle>-0       [008] ..s2. 4779449.360967: bpf_trace_printk: src ip c0a80164, dst port: 101, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [008] ..s2. 4779449.360968: bpf_trace_printk: [add_metadata_to_log] next_loc: 2, pkt_min: 1 pkt_max: 2
          <idle>-0       [008] ..s2. 4779449.360968: bpf_trace_printk: [update_state_by_metadata] new state 2 for src ip 6401a8c0
          <idle>-0       [008] ..s2. 4779449.360969: bpf_trace_printk: [add_metadata_to_log] add pkt 3 to ring[2]
          <idle>-0       [008] ..s2. 4779449.360971: bpf_trace_printk: src ip c0a80164, dst port: 102, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [008] ..s2. 4779449.360973: bpf_trace_printk: [add_metadata_to_log] next_loc: 3, pkt_min: 1 pkt_max: 3
          <idle>-0       [008] ..s2. 4779449.360974: bpf_trace_printk: [update_state_by_metadata] new state 3 for src ip 6401a8c0
          <idle>-0       [009] ..s2. 4779449.361899: bpf_trace_printk: 

          <idle>-0       [009] ..s2. 4779449.361904: bpf_trace_printk: Receive a packet on cpu 9
          <idle>-0       [009] ..s2. 4779449.361905: bpf_trace_printk: cur_pkt_id: 4
          <idle>-0       [009] ..s2. 4779449.361906: bpf_trace_printk: Detect packet loss, need to recover pkts [1, 2]
          <idle>-0       [009] ..s2. 4779449.361906: bpf_trace_printk: init LOST_FLAGS: 0x300
          <idle>-0       [009] ..s2. 4779449.361907: bpf_trace_printk: [handle_one_packet_loss] next pkt to recover: 1, lost_pkt_max: 2
          <idle>-0       [009] ..s2. 4779449.361910: bpf_trace_printk: [handle_one_packet_loss] to recover pkt 1
          <idle>-0       [009] ..s2. 4779449.361912: bpf_trace_printk: [add_metadata_to_log] add lost pkt 1 to ring[0]
          <idle>-0       [009] ..s2. 4779449.361914: bpf_trace_printk: [add_metadata_to_log] next_loc: 1, pkt_min: 1 pkt_max: 1
          <idle>-0       [009] ..s2. 4779449.361914: bpf_trace_printk: [handle_packet_loss] get metadata of pkt 1 from core 8
          <idle>-0       [009] ..s2. 4779449.361916: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 1, tcp_fin_flag: 0
          <idle>-0       [009] ..s2. 4779449.361918: bpf_trace_printk: [update_state_by_metadata] insert state 1 for src ip 6401a8c0
          <idle>-0       [009] ..s2. 4779449.361919: bpf_trace_printk: [handle_one_packet_loss] recover pkt 1 SUCCEED
          <idle>-0       [009] ..s2. 4779449.361919: bpf_trace_printk: [handle_one_packet_loss] next pkt to recover: 2, lost_pkt_max: 2
          <idle>-0       [009] ..s2. 4779449.361921: bpf_trace_printk: [handle_one_packet_loss] to recover pkt 2
          <idle>-0       [009] ..s2. 4779449.361921: bpf_trace_printk: [add_metadata_to_log] add lost pkt 2 to ring[1]
          <idle>-0       [009] ..s2. 4779449.361922: bpf_trace_printk: [add_metadata_to_log] next_loc: 2, pkt_min: 1 pkt_max: 2
          <idle>-0       [009] ..s2. 4779449.361923: bpf_trace_printk: [handle_packet_loss] get metadata of pkt 2 from core 8
          <idle>-0       [009] ..s2. 4779449.361924: bpf_trace_printk: src ip c0a80164, dst port: 101, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [009] ..s2. 4779449.361925: bpf_trace_printk: [update_state_by_metadata] new state 2 for src ip 6401a8c0
          <idle>-0       [009] ..s2. 4779449.361926: bpf_trace_printk: [handle_one_packet_loss] recover pkt 2 SUCCEED
          <idle>-0       [009] ..s2. 4779449.361927: bpf_trace_printk: [handle_one_packet_loss] next pkt to recover: 3, lost_pkt_max: 2
          <idle>-0       [009] ..s2. 4779449.361927: bpf_trace_printk: [handle_packet_loss] SUCCEED
          <idle>-0       [009] ..s2. 4779449.361928: bpf_trace_printk: [add_metadata_to_log] add pkt 3 to ring[2]
          <idle>-0       [009] ..s2. 4779449.361929: bpf_trace_printk: src ip c0a80164, dst port: 102, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [009] ..s2. 4779449.361931: bpf_trace_printk: [add_metadata_to_log] next_loc: 3, pkt_min: 1 pkt_max: 3
          <idle>-0       [009] ..s2. 4779449.361932: bpf_trace_printk: [update_state_by_metadata] new state 3 for src ip 6401a8c0
          <idle>-0       [009] ..s2. 4779449.361932: bpf_trace_printk: [add_metadata_to_log] add pkt 4 to ring[3]
          <idle>-0       [009] ..s2. 4779449.361933: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [009] ..s2. 4779449.361935: bpf_trace_printk: [add_metadata_to_log] next_loc: 4, pkt_min: 1 pkt_max: 4
          <idle>-0       [009] ..s2. 4779449.361936: bpf_trace_printk: [update_state_by_metadata] new state 0 for src ip 6401a8c0
          <idle>-0       [008] ..s2. 4779449.362675: bpf_trace_printk: 

          <idle>-0       [008] ..s2. 4779449.362677: bpf_trace_printk: Receive a packet on cpu 8
          <idle>-0       [008] ..s2. 4779449.362678: bpf_trace_printk: cur_pkt_id: 5
          <idle>-0       [008] ..s2. 4779449.362678: bpf_trace_printk: [add_metadata_to_log] add pkt 4 to ring[3]
          <idle>-0       [008] ..s2. 4779449.362678: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [008] ..s2. 4779449.362679: bpf_trace_printk: [add_metadata_to_log] next_loc: 4, pkt_min: 1 pkt_max: 4
          <idle>-0       [008] ..s2. 4779449.362679: bpf_trace_printk: [update_state_by_metadata] new state 0 for src ip 6401a8c0
          <idle>-0       [008] ..s2. 4779449.362680: bpf_trace_printk: [add_metadata_to_log] add pkt 5 to ring[4]
          <idle>-0       [008] ..s2. 4779449.362680: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [008] ..s2. 4779449.362682: bpf_trace_printk: [add_metadata_to_log] next_loc: 5, pkt_min: 1 pkt_max: 5
          <idle>-0       [008] ..s2. 4779449.362683: bpf_trace_printk: [update_state_by_metadata] new state 1 for src ip 6401a8c0
          <idle>-0       [009] ..s2. 4779449.363449: bpf_trace_printk: 

          <idle>-0       [009] ..s2. 4779449.363452: bpf_trace_printk: Receive a packet on cpu 9
          <idle>-0       [009] ..s2. 4779449.363452: bpf_trace_printk: cur_pkt_id: 6
          <idle>-0       [009] ..s2. 4779449.363453: bpf_trace_printk: [add_metadata_to_log] add pkt 5 to ring[4]
          <idle>-0       [009] ..s2. 4779449.363453: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [009] ..s2. 4779449.363454: bpf_trace_printk: [add_metadata_to_log] next_loc: 5, pkt_min: 1 pkt_max: 5
          <idle>-0       [009] ..s2. 4779449.363456: bpf_trace_printk: [update_state_by_metadata] new state 1 for src ip 6401a8c0
          <idle>-0       [009] ..s2. 4779449.363457: bpf_trace_printk: [add_metadata_to_log] add pkt 6 to ring[5]
          <idle>-0       [009] ..s2. 4779449.363457: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [009] ..s2. 4779449.363458: bpf_trace_printk: [add_metadata_to_log] next_loc: 6, pkt_min: 1 pkt_max: 6
          <idle>-0       [009] ..s2. 4779449.363458: bpf_trace_printk: [update_state_by_metadata] new state 0 for src ip 6401a8c0
          <idle>-0       [008] ..s2. 4779449.364227: bpf_trace_printk: 

          <idle>-0       [008] ..s2. 4779449.364230: bpf_trace_printk: Receive a packet on cpu 8
          <idle>-0       [008] ..s2. 4779449.364230: bpf_trace_printk: cur_pkt_id: 7
          <idle>-0       [008] ..s2. 4779449.364230: bpf_trace_printk: [add_metadata_to_log] add pkt 6 to ring[5]
          <idle>-0       [008] ..s2. 4779449.364231: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 0
          <idle>-0       [008] ..s2. 4779449.364231: bpf_trace_printk: [add_metadata_to_log] next_loc: 6, pkt_min: 1 pkt_max: 6
          <idle>-0       [008] ..s2. 4779449.364231: bpf_trace_printk: [update_state_by_metadata] new state 0 for src ip 6401a8c0
          <idle>-0       [008] ..s2. 4779449.364232: bpf_trace_printk: [add_metadata_to_log] add pkt 7 to ring[6]
          <idle>-0       [008] ..s2. 4779449.364232: bpf_trace_printk: src ip c0a80164, dst port: 100, tcp_syn_flag: 0, tcp_fin_flag: 1
          <idle>-0       [008] ..s2. 4779449.364232: bpf_trace_printk: [add_metadata_to_log] next_loc: 7, pkt_min: 1 pkt_max: 7
          <idle>-0       [008] ..s2. 4779449.364233: bpf_trace_printk: [update_state_by_metadata] remove state 1 for src ip 6401a8c0
